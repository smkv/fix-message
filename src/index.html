<!DOCTYPE html>
<html lang="en">
<!--
FIX Message decoder
Copyright (c) 2025 Andrei Samkov

This source code is licensed under the MIT license found in the LICENSE.txt file.
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>FIX message decoder</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body>
<div class="pb-3 mb-4 border-bottom">
    <header class="container py-3">
        <a href="/" class="d-flex align-items-center text-body-emphasis text-decoration-none">
            <img src="fix-decoder.svg" alt="Logo" height="50" class="me-4">
            <span class="fs-4">FIX message decoder</span>
        </a>
    </header>
</div>
<div class="container">
    <form>
        <div class="mb-3">
            <label for="fixMessageTextarea" class="form-label">FIX message</label>
            <textarea class="form-control" id="fixMessageTextarea" aria-describedby="fixMessageHelp" placeholder="E.g. 8=FIX.4.4|9=65|35=A|...|10=059|"></textarea>
            <div id="fixMessageHelp" class="form-text">Enter a FIX message to decode. All processing is done locally in
                your browser, so your data remains secure and is never sent to a server. The standard SOH delimiter is
                always supported. E.g. 8=FIX.4.2|9=65|35=A|...|10=059|. See more in <a href="https://en.wikipedia.org/wiki/Financial_Information_eXchange" target="_blank">Wikipedia</a>.
            </div>
        </div>
        <div class="mb-3 row">
            <div class="col-md-4 col-sm-12">
                <label for="delimiterInput" class="form-label">Delimiter</label>
                <input type="text" class="form-control" id="delimiterInput" value="|" size="1" maxlength="1"
                       style="width: 40px;">
            </div>
            <div class="col-md-4 col-sm-12">
                <label for="dataDictionarySelect" class="form-label">Data Dictionary</label>
                <select class="form-select" id="dataDictionarySelect">
                    <option value="auto">Auto</option>
                    <option value="FIX50SP2.xml">FIX.5.0 SP2</option>
                    <option value="FIX50SP1.xml">FIX.5.0 SP1</option>
                    <option value="FIX50.xml">FIX.5.0</option>
                    <option value="FIX44.xml">FIX.4.4</option>
                    <option value="FIX43.xml">FIX.4.3</option>
                    <option value="FIX42.xml">FIX.4.2</option>
                    <option value="FIX41.xml">FIX.4.1</option>
                    <option value="FIX40.xml">FIX.4.0</option>
                    <option value="custom">Custom...</option>
                </select>
            </div>
            <div class="col-md-4 col-sm-12 fade">
                <label for="customDataDictionaryFile" class="form-label">Custom Data Dictionary</label>
                <input type="file" class="form-control" id="customDataDictionaryFile" accept=".xml" disabled>
            </div>
        </div>
    </form>
    <hr/>
    <fix-message id="fixMessage" message="" mode="table"></fix-message>
    <hr/>
    <div class="text-muted">
        Powered by <a href="https://github.com/smkv/fix-message" target="_blank">fix-message</a>, an open-source Web
        Component for decoding FIX messages.
    </div>
    <div class="text-muted">
        This project is licensed under the MIT License. See the <a href="LICENSE.txt">LICENSE</a> file for details.
    </div>
    <div class="text-muted">
        Copyright &copy; 2025 Andrei Samkov
    </div>
</div>
<script src="fix-message.mjs" type="module"></script>
<script>
    const fixMessageTextarea = document.getElementById('fixMessageTextarea');
    const delimiterInput = document.getElementById('delimiterInput');
    const dataDictionarySelect = document.getElementById('dataDictionarySelect');
    const customDataDictionaryFile = document.getElementById('customDataDictionaryFile');
    const customDataDictionaryColumn = customDataDictionaryFile.closest('div.col');
    const fixMessage = document.getElementById('fixMessage');

    fixMessageTextarea.addEventListener('input', () => {
        const message = fixMessageTextarea.value;
        fixMessage.message = message;
        const delimiters = [String.fromCharCode(1), '|', '^', '$', 'Â·', '\t', '\n'];

        for (const delimiter of delimiters) {
            if (message.includes(delimiter) && delimiterInput.value !== delimiter) {
                delimiterInput.value = delimiter;
                break;
            }
        }
    });

    delimiterInput.addEventListener('input', () => {
        fixMessage.delimiter = delimiterInput.value;
    });

    dataDictionarySelect.addEventListener('change', () => {
        const value = dataDictionarySelect.value;
        customDataDictionaryColumn.classList.toggle('fade', value !== 'custom');
        customDataDictionaryFile.disabled = value !== 'custom';
        switch (value) {
            case 'custom':
                customDataDictionaryFile.dispatchEvent(new Event('change'));
                break;
            case 'auto':
                fixMessage.dataDictionary = '';
                break;
            default:
                fixMessage.dataDictionary = value;
                break;
        }
    });

    customDataDictionaryFile.addEventListener('change', () => {
        const file = customDataDictionaryFile.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                fixMessage.dataDictionary = e.target.result;
            };
            reader.readAsText(file);
        } else {
            fixMessage.dataDictionary = '';
        }

    });
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NFXQR34XHM"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-NFXQR34XHM');
</script>
</body>
</html>